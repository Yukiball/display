<template><div><!--
 * @Author: yukiball yukiball
 * @Date: 2024-07-11 16:08:53
 * @LastEditors: yukiball yukiball
 * @LastEditTime: 2024-07-13 22:45:34
 * @FilePath: \display\docs\vue\åŒå‘æ•°æ®ç»‘å®š.md
 * @Description:
 *
 * Copyright (c) 2024 by ${git_name_email}, All Rights Reserved.
-->
<h1 id="åŒå‘æ•°æ®ç»‘å®š" tabindex="-1"><a class="header-anchor" href="#åŒå‘æ•°æ®ç»‘å®š"><span>åŒå‘æ•°æ®ç»‘å®š</span></a></h1>
<p>ä¼—æ‰€å‘¨çŸ¥ vue çš„åŒå‘æ•°æ®ç»‘å®šå¾ˆå¼ºå¤§ï¼Œé‚£ä¹ˆä»–åˆ°åº•æ˜¯ä»¥ä»€ä¹ˆæ€è·¯å®ç°çš„å‘¢ï¼Ÿ</p>
<h2 id="vue2-0" tabindex="-1"><a class="header-anchor" href="#vue2-0"><span>vue2.0</span></a></h2>
<p>ä»ç½‘ä¸ŠæŸ¥è¯¢ vue åŒå‘æ•°æ®ç»‘å®šçš„å®ç°ï¼Œå¯ä»¥æŸ¥åˆ°è¿™ç§ç­”æ¡ˆâ€œé€šè¿‡ç»“åˆå¯¹è±¡çš„ <code v-pre>getter</code> å’Œ <code v-pre>setter</code>ï¼Œä»¥åŠ <code v-pre>Object.defineProperty()</code> æ–¹æ³•æ¥å®ç°çš„ã€‚å…·ä½“æ¥è¯´ï¼Œå½“ä½ åœ¨ Vue å®ä¾‹ä¸­ä½¿ç”¨ <code v-pre>v-model</code> æŒ‡ä»¤æ—¶ï¼ŒVue ä¼šåœ¨å†…éƒ¨åˆ›å»ºä¸€ä¸ªæŒ‡ä»¤ç›¸å…³çš„ <code v-pre>watcher</code> å¯¹è±¡ï¼Œç”¨æ¥è¿½è¸ªæ•°æ®çš„å˜åŒ–ã€‚åŒæ—¶ï¼ŒVue è¿˜ä¼šåˆ©ç”¨ <code v-pre>Object.defineProperty()</code> æ¥å°†æ•°æ®å¯¹è±¡çš„å±æ€§è½¬åŒ–ä¸º getter å’Œ setterï¼Œä»è€Œåœ¨æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œèƒ½å¤Ÿé€šçŸ¥åˆ°ç›¸å…³çš„è§†å›¾æ›´æ–°ï¼Œä»¥åŠåœ¨è§†å›¾ä¸­è¾“å…¥æ¡†å†…å®¹å˜åŒ–æ—¶ï¼Œæ›´æ–°åˆ°æ•°æ®å±‚ã€‚â€ï¼ˆæ¥æºäº ChatGPT3.5ï¼‰</p>
<p>(âŠ™oâŠ™)â€¦å›ç­”çš„å¾ˆå¥½ï¼Œä½†æ˜¯ watcher åˆ°åº•æ€ä¹ˆè¿½è¸ªæ•°æ®çš„å˜åŒ–å‘¢ï¼Ÿ åˆæ˜¯æ€ä¹ˆè®© dom æ•°æ®æ›´æ–°ï¼Œä»¥åŠæ€ä¹ˆåœ¨è§†å›¾ä¸­è¾“å…¥æ¡†å†…å®¹å˜åŒ–æ—¶ï¼Œæ›´æ–°åˆ°æ•°æ®å±‚çš„å‘¢ï¼Ÿï¼Ÿå¸¦ç€è¿™äº›ç–‘é—®æˆ‘ä»¬å°±æ¥æ‰‹å†™ä¸€ä¸ªç®€å•çš„åŒå‘æ•°æ®ç»‘å®šã€‚</p>
<p><a href="#%E6%80%BB%E7%BB%93">ç€æ€¥çœ‹ä»£ç æ€»ç»“ç‚¹è¿™é‡Œ</a></p>
<h3 id="step-one" tabindex="-1"><a class="header-anchor" href="#step-one"><span>Step Oneï¼š</span></a></h3>
<p>æˆ‘ä»¬å…ˆåœ¨ js é‡Œé¢å®šä¹‰æ”¹å˜ dom ç»“æ„æ•°æ®çš„æ–¹æ³•ã€‚åˆ›å»º observer æ–¹æ³•ç”¨æ¥æ‰§è¡Œ Object.defineProperty()ä¿®æ”¹å¯¹è±¡çš„ get å’Œ setï¼Œç”¨ for å¾ªç¯å»éå†æˆ‘ä»¬å®šä¹‰çš„å¯¹è±¡ï¼Œè¿™æ ·åœ¨ä¸¤ä¸ª changeXXX æ–¹æ³•è§¦å‘çš„æ—¶å€™å°±èƒ½è§¦å‘æˆ‘ä»¬åœ¨ getï¼Œset ä¸­æ–°å®šä¹‰çš„æ–¹æ³•ã€‚å°†å¯¹è±¡å˜æˆå“åº”å¼çš„å¯¹è±¡ï¼Œè®©æ•°æ®è¯»å–å’Œä¿®æ”¹æ—¶èƒ½è¢«æ„ŸçŸ¥åˆ°ã€‚</p>
<CodeGroup>
<CodeGroupItem title="myVue.js">
<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> someBody <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">myName</span><span class="token operator">:</span> <span class="token string">"yuki"</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// è½¬æ¢someBody</span></span>
<span class="line"><span class="token function">observer</span><span class="token punctuation">(</span>someBody<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">changeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  dom<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> someBody<span class="token punctuation">.</span>myName<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">changeAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  dom<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> someBody<span class="token punctuation">.</span>age<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">changeInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  dom<span class="token punctuation">.</span>value <span class="token operator">=</span> someBody<span class="token punctuation">.</span>myName<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// å°†æ•°æ®å˜æˆå“åº”å¼</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> internalValue <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> internalValue<span class="token punctuation">;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        internalValue <span class="token operator">=</span> val<span class="token punctuation">;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token function">changeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">changeAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></CodeGroupItem>
<CodeGroupItem title="html">
<div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre v-pre class="language-html"><code><span class="line"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>å§“åï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>å¹´é¾„ï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">onInput</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>someBody.myName = this.value<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span>
<span class="line"></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./myVue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></CodeGroupItem>
</CodeGroup>
<p>è¿™æ—¶æˆ‘ä»¬ä¼šå‘ç°ï¼Œæ‰§è¡Œä¸€æ¬¡ä¹‹åå°±ç»“æŸäº†ï¼Œåé¢æˆ‘ä»¬å†å»æ”¹å˜å¯¹è±¡ä¸­çš„ä»»ä½•å±æ€§å°±ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œç„¶åæˆ‘ä»¬ç»§ç»­å¯¹ js æ–‡ä»¶è¿›è¡Œå®Œå–„</p>
<h3 id="step-two" tabindex="-1"><a class="header-anchor" href="#step-two"><span>Step Twoï¼š</span></a></h3>
<p>è¦è®©æ•°æ®è¢«è¯»å–ï¼ˆget æ‰§è¡Œï¼‰çš„æ—¶å€™çŸ¥é“æ˜¯è°åœ¨è¯»å–ï¼Œæ•°æ®æ›´æ–°ï¼ˆset æ‰§è¡Œï¼‰çš„æ—¶å€™å»é€šçŸ¥é‚£äº›ç”¨åˆ°è¿™æ¡æ•°æ®çš„æ–¹æ³•</p>
<div class="custom-container tip"><p class="custom-container-title">æƒ³ä¸€æƒ³ï¼š</p>
<p>æˆ‘ä»¬è¦æ€ä¹ˆå°†è‡ªå·±å®šä¹‰çš„æ–¹æ³•åœ¨ setter è¢«è°ƒç”¨æ—¶å»æ‰§è¡Œå‘¢ï¼Ÿæ€ä¹ˆè®© Dep çŸ¥é“å‘¢ï¼Ÿè‚¯å®šä¸èƒ½æ‰‹åŠ¨æ·»åŠ å§ â•®(â”€â–½â”€)â•­</p>
</div>
<p>setterï¼šæˆ‘ä¸çŸ¥é“è°ç”¨è°ƒç”¨äº†æˆ‘ä»¬çš„å¯¹è±¡ï¼Œä½†æ˜¯ getter å¯ä»¥çŸ¥é“å‘€~ä»–å¯ä»¥å‘Šè¯‰æˆ‘ã€‚</p>
<ol>
<li>å…ˆå®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ window.__func</li>
<li>å®šä¹‰ä¸€ä¸ªæ–¹æ³•å»ç”¨æ¥æ‰§è¡Œæˆ‘ä»¬çš„ changeXXX æ–¹æ³•ï¼Œå¹¶åœ¨æ‰§è¡Œå‰å°† changeXXX æ–¹æ³•æŒ‚è½½åˆ°æˆ‘ä»¬å®šä¹‰çš„å…¨å±€å˜é‡ä¸Šï¼Œå¹¶åœ¨æ–¹æ³•æ‰§è¡Œå®Œä¹‹åæ¢å¤å…¨å±€å˜é‡ä¸º nullã€‚</li>
<li>åœ¨æ–¹ changeXXX æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„ get å¯ä»¥è¢«è§¦å‘å¹¶ä¿å­˜ window.__func åœ¨æ•°ç»„ä¸­ï¼ˆä¸ºä»€ä¹ˆæ˜¯æ•°ç»„å‘¢ï¼Ÿå› ä¸ºè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•å¯èƒ½ä¼šæœ‰å¾ˆå¤šï¼‰</li>
<li>åœ¨èµ‹å€¼æ–¹æ³•æ‰§è¡Œæ—¶ set æ–¹æ³•ä¸­ä¼šéå†å‚¨å­˜çš„æ–¹æ³•ï¼Œä¾æ¬¡æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°åŒå‘æ•°æ®ç»‘å®šçš„æ•ˆæœ~</li>
</ol>
<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="line">window<span class="token punctuation">.</span>__func <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  window<span class="token punctuation">.</span>__func <span class="token operator">=</span> fn<span class="token punctuation">;</span></span>
<span class="line">  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  window<span class="token punctuation">.</span>__func <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> internalValue <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">const</span> func <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¿è¯æ–¹æ³•å”¯ä¸€</span></span>
<span class="line">    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">// ä¾èµ–æ”¶é›†</span></span>
<span class="line">      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>__func<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">          func<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>__func<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword">return</span> internalValue<span class="token punctuation">;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token comment">// æ´¾å‘æ›´æ–°</span></span>
<span class="line">      <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        internalValue <span class="token operator">=</span> val<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> value <span class="token keyword">of</span> set<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token function">action</span><span class="token punctuation">(</span>changeName<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">action</span><span class="token punctuation">(</span>changeAge<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">action</span><span class="token punctuation">(</span>changeInput<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h3>
<p>è°ƒç”¨ Object.defineProperty() ç»™å¯¹è±¡çš„ get å’Œ set ä¸­æ·»åŠ ä¸€äº›æ–¹æ³•ï¼Œåšåˆ°â€œåœ¨ get ä¸­è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œè®°å½•æ˜¯å“ªä¸ªå‡½æ•°åœ¨è°ƒç”¨æˆ‘ä»¬çš„å¯¹è±¡ï¼›åœ¨ set ä¸­æ´¾å‘æ›´æ–°ï¼Œé‡æ–°æ‰§è¡Œç”¨æˆ‘çš„å‡½æ•°â€è¿™æ ·åŒå‘æ•°æ®ç»‘å®šå°±æˆåŠŸäº†~å½“ç„¶ vue ä¸­çš„å®ç°è‚¯å®šä¸ä¼šè¿™ä¹ˆç®€å•ï¼Œè¿˜éœ€è¦è€ƒè™‘å¯¹è±¡çš„æ·±å±‚éå†ã€å°†æ´¾å‘çš„æ–¹æ³•æ”¾åˆ°å¾®ä»»åŠ¡å»æ‰§è¡Œç­‰ç­‰å¾ˆå¤šä¸œè¥¿ï¼Œæˆ‘ä»¬è¿™é‡Œåªæ˜¯ä¾ç…§ä»–çš„æ€è·¯å®ç°äº†ä¸€ä¸ªæœ€æœ€ç®€å•çš„åŒå‘æ•°æ®ç»‘å®š~
ğŸ˜„æŸä¸ªå¤§ç¥è¯´è¿‡ï¼šâ€œè¶Šå¤æ‚çš„ä»£ç ç©¶å…¶åŸç†å¾€å¾€è¶Šç®€å•â€ã€‚</p>
<p>ä¸‹é¢å°±æ˜¯æˆ‘è¿™æ¬¡å®ç°çš„æ‰€æœ‰ä»£ç ~å¯ä»¥å¤åˆ¶åˆ°æµè§ˆå™¨è‡ªè¡Œä½“éªŒ~</p>
<CodeGroup>
<CodeGroupItem title="myVue.js">
<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> someBody <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">myName</span><span class="token operator">:</span> <span class="token string">"yuki"</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">observer</span><span class="token punctuation">(</span>someBody<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">changeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  dom<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> someBody<span class="token punctuation">.</span>myName<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">changeAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  dom<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> someBody<span class="token punctuation">.</span>age<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">changeInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  dom<span class="token punctuation">.</span>value <span class="token operator">=</span> someBody<span class="token punctuation">.</span>myName<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// å°†æ•°æ®å˜æˆå“åº”å¼</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> internalValue <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">const</span> func <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¿è¯æ–¹æ³•å”¯ä¸€</span></span>
<span class="line">    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">// ä¾èµ–æ”¶é›†</span></span>
<span class="line">      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>__func<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">          func<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>__func<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword">return</span> internalValue<span class="token punctuation">;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token comment">// æ´¾å‘æ›´æ–°</span></span>
<span class="line">      <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        internalValue <span class="token operator">=</span> val<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> value <span class="token keyword">of</span> func<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">window<span class="token punctuation">.</span>__func <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  window<span class="token punctuation">.</span>__func <span class="token operator">=</span> fn<span class="token punctuation">;</span></span>
<span class="line">  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  window<span class="token punctuation">.</span>__func <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token function">action</span><span class="token punctuation">(</span>changeName<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">action</span><span class="token punctuation">(</span>changeAge<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">action</span><span class="token punctuation">(</span>changeInput<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></CodeGroupItem>
<CodeGroupItem title="index.html">
<div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre v-pre class="language-html"><code><span class="line"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>å§“åï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>å¹´é¾„ï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">onInput</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>someBody.myName = this.value<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./myVue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></CodeGroupItem>
</CodeGroup>
</div></template>


